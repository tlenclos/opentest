{% extends layout %}

{% form_theme form 'Form/form.twig' %}

{% block content_title %}{{ title }}{% endblock %}

{% block content %}

    {% include 'sites-infos.twig' %}

    <div id="start-pentest">
        <h3>Ajouter un pentest</h3>

        <form id="start-pentest-form" action="" method="post" class="well">
            <div id="pentest-inputs">
                {{ form_widget(form) }}
                <button type="submit" id="submit-pentest" class="btn btn-info">Démarrer</button>
            </div>

            <div id="messages">
            </div>

            <div style="clear: both"></div>
        </form>

    </div>

    <h3>En cours d'exécution</h3>
    <div id="running-commands" class="accordion"></div>

    <h3>Sauvegardés</h3>
    <div class="accordion">

        {% set reportNumber = 0 %}
        {% for file in files %}
            {% set reportNumber = reportNumber+1 %}
            <div class="accordion-group well-small">
                <div class="accordion-heading">
                    <a class="accordion-toggle" data-toggle="collapse"
                       href="#report-{{ reportNumber }}">{{ file.getFilename()|trim('.log')|url_decode }}</a>
                </div>
                <div id="report-{{ reportNumber }}" class="accordion-body collapse">
                    <div class="accordion-inner">
                <pre>
                    {{ file.getContents() }}
                </pre>
                    </div>
                </div>
            </div>
        {% endfor %}

    </div>
{% endblock %}